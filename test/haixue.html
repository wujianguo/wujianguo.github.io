<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>Haixue</title>
</head>

<body>
    <div class="row">
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">基本信息</h5>
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Name</th>
                                <th scope="col">Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">1</th>
                                <td>User-Agent</td>
                                <td name="ua">Otto</td>
                            </tr>
                            <tr>
                                <th scope="row">2</th>
                                <td>uid</td>
                                <td name="uid"></td>
                            </tr>
                            <tr>
                                <th scope="row">3</th>
                                <td>url</td>
                                <td name="url"></td>
                            </tr>
                            <tr>
                                <th scope="row">4</th>
                                <td>test</td>
                                <td name="test"><a href="hxkt://seller/activity?url=https%3A%2F%2Fxing-ou.github.io%2FjsBridgeWebPage%2Fwkweb.html">openHaiXueApp3</a></td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- <p class="card-text" name="ua">hxkt://</p> -->
                </div>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">商品详情页</h5>
                    <p class="card-text" name="goods_url">hxkt://</p>
                    <!-- <p class="card-text">输入商品 id，跳转方式和购买成功后的回调地址（可选）</p> -->
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">商品 id</span>
                        </div>
                        <input name="goods_id" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default"
                                for="present_type_select">跳转方式</span>
                        </div>
                        <select class="custom-select" id="present_type_select">
                            <!-- <option selected>请选择...</option> -->
                            <option selected value="push">push</option>
                            <option value="modal">modal</option>
                        </select>
                        <!-- <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"> -->
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">回调地址</span>
                        </div>
                        <input name="callback" type="text" class="form-control" placeholder="url 地址，可不填"
                            aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
                    </div>

                    <a href="#" name="buy" class="btn btn-primary">去购买</a>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">订单详情页</h5>
                    <p class="card-text" name="order_url">hxkt://</p>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">订单 id</span>
                        </div>
                        <input name="order_id" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">回调地址</span>
                        </div>
                        <input name="callback_order" type="text" class="form-control" placeholder="url 地址，可不填"
                            aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
                    </div>
                    <a href="#" name="order" class="btn btn-primary">去付款</a>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">嗨聊直播间</h5>
                    <p class="card-text" name="live_url">hxkt://</p>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">直播 id</span>
                        </div>
                        <input name="live_id" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <a href="#" name="watch" class="btn btn-primary">去观看</a>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">自定义</h5>
                    <!-- <p class="card-text" name="custom_url">hxkt://</p> -->
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">url</span>
                        </div>
                        <input name="custom_url" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <a href="#" name="custom_url" class="btn btn-primary">Go</a>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">跳转到订单列表</h5>
                    <a href="hxkt://order/list" name="custom_url" class="btn btn-primary">Go</a>
                </div>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">微信分享文字</h5>
                    <!-- <p class="card-text" name="custom_url">hxkt://</p> -->
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">内容</span>
                        </div>
                        <input name="share_text" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default"
                                for="share_text_type_select">分享到</span>
                        </div>
                        <select class="custom-select" id="share_text_type_select">
                            <!-- <option selected>请选择...</option> -->
                            <option selected value="timeline">朋友圈</option>
                            <option value="session">微信好友</option>
                        </select>
                        <!-- <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"> -->
                    </div>
                    <!-- <a href="#" name="custom_url" class="btn btn-primary">分享</a> -->
                    <button type="button" class="btn btn-primary" onclick="shareText()">分享</button>

                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">微信分图片</h5>
                    <div>
                        <button type="button" class="btn btn-primary">选择图片</button>
                    </div>
                    <div>
                        <img id="share_img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
    9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="share image" />
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default"
                                for="share_image_type_select">分享到</span>
                        </div>
                        <select class="custom-select" id="share_image_type_select">
                            <!-- <option selected>请选择...</option> -->
                            <option selected value="timeline">朋友圈</option>
                            <option value="session">微信好友</option>
                        </select>
                        <!-- <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"> -->
                    </div>
                    <button type="button" class="btn btn-primary" onclick="shareImage()">分享</button>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">微信分享小程序</h5>
                    <!-- <p class="card-text" name="custom_url">hxkt://</p> -->
                    <div>
                        <button type="button" class="btn btn-primary">选择图片</button>
                    </div>
                    <div>
                        <img id="share_img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
    9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="share image" />
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">webpageUrl</span>
                        </div>
                        <input name="custom_url" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default" placeholder="兼容低版本的网页链接">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">userName</span>
                        </div>
                        <input name="custom_url" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default" placeholder="登录小程序管理后台-设置-基本设置-帐号信息">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default">path</span>
                        </div>
                        <input name="custom_url" type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-default" placeholder="小程序的页面路径">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-default"
                                for="present_type_select">miniProgramType</span>
                        </div>
                        <select class="custom-select" id="present_type_select">
                            <!-- <option selected>请选择...</option> -->
                            <option selected value="release">正式版</option>
                            <option value="test">开发版</option>
                            <option value="preview">体验版</option>
                        </select>
                        <!-- <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default"> -->
                    </div>
                    <!-- <a href="#" name="custom_url" class="btn btn-primary">分享</a> -->
                    <button type="button" class="btn btn-primary" onclick="shareText()">分享</button>

                </div>
            </div>
        </div>

        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">微信登录</h5>
                    <button type="button" class="btn btn-primary" onclick="shareText()">登录</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>

    <script type="text/javascript">

        $("td[name='url']").text(window.location.href);
        $("td[name='ua']").text(navigator.userAgent);

        const urlParams = new URLSearchParams(window.location.search);
        const uid = urlParams.get('uid');
        $("td[name='uid']").text(uid);


        function update_goods() {
            var t = $('#present_type_select').find("option:selected").val();
            var id = $("input[name='goods_id']").val();
            var callback_url = $("input[name='callback']").val();
            var url = "hxkt://goods/detail?" + "id=" + id + "&present=" + t;
            if (callback_url.length > 0) {
                var u = encodeURIComponent(callback_url)
                url = "hxkt://goods/detail?" + "id=" + id + "&present=" + t + "&callback=" + u;
            }
            $("a[name='buy']").attr("href", url);
            $("p[name='goods_url']").text(url);
        }

        $('#present_type_select').on('change', function (e) {
            update_goods();
        });

        $("input[name='goods_id']").on('input', function (e) {
            update_goods();
        });

        $("input[name='callback']").on('input', function (e) {
            update_goods();
        });

        function update_order() {
            var id = $("input[name='order_id']").val();
            var url = "hxkt://order/detail?" + "id=" + id
            var callback_url = $("input[name='callback_order']").val();

            if (callback_url.length > 0) {
                var u = encodeURIComponent(callback_url)
                url = "hxkt://order/detail?" + "id=" + id + "&callback=" + u;
            }

            $("a[name='order']").attr("href", url);
            $("p[name='order_url']").text(url);
        }


        $("input[name='callback_order']").on('input', function (e) {
            update_order();
        });

        $("input[name='live_id']").on('input', function (e) {
            var id = $("input[name='live_id']").val();
            var url = "hxkt://live/highchat?" + "id=" + id

            $("a[name='watch']").attr("href", url);
            $("p[name='live_url']").text(url);

        });

        $("input[name='order_id']").on('input', function (e) {
            update_order();
            // var id = $("input[name='order_id']").val();
            // var url = "hxkt://order/detail?" + "id=" + id

            // $("a[name='order']").attr("href", url);
            // $("p[name='order_url']").text(url);

        });

        $("input[name='custom_url']").on('input', function (e) {
            var url = $("input[name='custom_url']").val();
            $("a[name='custom_url']").attr("href", url);
        });

        function shareText() {
            shareToWechat("share", "text", "moment", "12hdjene");
        }


        function authWechat() {
            var data = {
                "id": ""
            };
            window.webkit.messageHandlers.authWechat.postMessage(data);
        }

        function onWechatAuth(result) {
            console.log(result.id);
            console.log(result.data);
        }

        /*
        *
        * 分享小程序
        */
        function shareMiniProgram() {
            var data = {
                "id": "",
                "webpageUrl": "",
                "userName": "",
                "path": "",
                "hdImageData": "",
                "withShareTicket": true,
                "miniProgramType": ""
            };
            window.webkit.messageHandlers.shareMiniProgram.postMessage(data);
        }

        /*
        *   content: 内容，文字或者图片，图片为 base64 编码，如 data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
    9TXL0Y4OHwAAAABJRU5ErkJggg==
        *   contentType: 类型，text 或者 image
        *   shareType: 分享到哪里，朋友圈: session, 聊天界面:timeline
        *   id: 分享标识，用于在回调时可以作判断是哪个分享回调的
        */
        function shareToWechat(content, contentType, shareType, id) {
            var data = {
                "content": content,
                "contentType": contentType,
                "shareType": shareType,
                "id": id
            };
            window.webkit.messageHandlers.shareToWechat.postMessage(data);
        }

        /*
        *   分享结果：result
        *   result.code: 为 0 则成功，其他则失败，目前微信限制了，用户如果取消了也会返回成功
        *   result.id: shareToWechat 传入的 id
        */
        function onWechatShareResult(result) {
            alert(result.id)
        }
    </script>

</body>

</html>
